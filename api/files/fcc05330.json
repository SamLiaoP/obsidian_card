{
  "file_id": "fcc05330",
  "name": "8.2a1l Summarization 摘要指標.md",
  "path": "8. 人工智能/8.2 如何優化RAG服務/8.2a1a 優化指標/8.2a1l Summarization 摘要指標.md",
  "content": "## LLM as a judge  \n\n## Required\n- User Input\n- LLM Output\n\n## 描述\n**摘要**指標使用 LLM 來評估生成的摘要是否正確地包含原始文本中的必要細節，並且事實上是正確的。此指標著重於檢查摘要內容是否與原始文本一致，並且沒有幻覺或矛盾訊息，並且包括所有必要的資訊。**SummarizationMetric** 是非快取的指標，需在每次測量時重新計算。\n\n## 計算方法\n摘要分數由以下兩個評估維度的最小值決定：\n\n$$\n\\text{Summarization} = \\min(\\text{Alignment Score}, \\text{Coverage Score})\n$$\n\n- **Alignment Score**：確保摘要內容不包含幻覺或與原文矛盾的訊息。\n- **Coverage Score**：確認摘要涵蓋了原文中的必要資訊。使用閉合問題（答案為「是」或「否」的問題）來計算此分數，並通過計算原文和摘要在問題上的一致回答比例來獲得。\n\n若其中任一分數為 0，最終的摘要分數也將為 0。\n\n## 程式碼\n```python\nfrom deepeval import evaluate\nfrom deepeval.metrics import SummarizationMetric\nfrom deepeval.test_case import LLMTestCase\n\n# 原始文本\ninput_text = \"\"\"\nThe 'coverage score' is calculated as the percentage of assessment questions\nfor which both the summary and the original document provide a 'yes' answer. This\nmethod ensures that the summary not only includes key information from the original\ntext but also accurately represents it. A higher coverage score indicates a\nmore comprehensive and faithful summary, signifying that the summary effectively\nencapsulates the crucial points and details from the original content.\n\"\"\"\n\n# 生成的摘要\nactual_output = \"\"\"\nThe coverage score quantifies how well a summary captures and\naccurately represents key information from the original text,\nwith a higher score indicating greater comprehensiveness.\n\"\"\"\n\n# 設定測試案例\ntest_case = LLMTestCase(input=input_text, actual_output=actual_output)\nmetric = SummarizationMetric(\n    threshold=0.5,\n    model=\"gpt-4\",\n    assessment_questions=[\n        \"Is the coverage score based on a percentage of 'yes' answers?\",\n        \"Does the score ensure the summary's accuracy with the source?\",\n        \"Does a higher score mean a more comprehensive summary?\"\n    ]\n)\n\n# 計算摘要分數\nmetric.measure(test_case)\nprint(\"Summarization Score:\", metric.score)\nprint(\"Explanation:\", metric.reason)\nprint(\"Score Breakdown:\", metric.score_breakdown)\n```\n\n在這段程式碼中，`Summarization Score` 為對齊分數和涵蓋分數的最小值。\n\n\n## 參考資料：\nhttps://docs.confident-ai.com/docs/metrics-summarization",
  "size": 2017,
  "lines": 68
}